#include <stdio.h>
#include <stdlib.h>
#include <conio.h>
#include <ctype.h>

struct info
{
    int data;
    struct info *next;
};

struct info *head = NULL, *temp = NULL, *disp = NULL;

/* Function declarations */
void additem();
void delitem();
void display();
int size();
void search();

int main()
{
    int choice;
    clrscr();

    while (1)
    {
        printf("\n1. Add records");
        printf("\n2. Delete records");
        printf("\n3. Display records");
        printf("\n4. Count number of items in the list");
        printf("\n5. Search an item in the list");
        printf("\n6. Exit");
        printf("\nEnter your choice: ");
        scanf("%d", &choice);

        switch (choice)
        {
        case 1:
            additem();
            break;
        case 2:
            delitem();
            break;
        case 3:
            display();
            break;
        case 4:
            printf("\nThe size of the list is %d", size());
            break;
        case 5:
            search();
            break;
        case 6:
            exit(0);
        default:
            printf("\nInvalid choice!");
        }
    }
}

/* Add item */
void additem()
{
    struct info *add;
    char proceed = 'y';

    while (toupper(proceed) == 'Y')
    {
        add = (struct info *)malloc(sizeof(struct info));
        printf("Enter data: ");
        scanf("%d", &add->data);
        add->next = NULL;

        if (head == NULL)
        {
            head = temp = add;
        }
        else
        {
            temp->next = add;
            temp = add;
        }

        printf("Want to proceed (y/n): ");
        scanf(" %c", &proceed);
    }
}

/* Delete item */
void delitem()
{
    struct info *curr, *prev;
    int tdata;

    if (head == NULL)
    {
        printf("\nNo records to delete");
        return;
    }

    printf("\nEnter the data to delete: ");
    scanf("%d", &tdata);

    curr = head;
    prev = NULL;

    while (curr != NULL && curr->data != tdata)
    {
        prev = curr;
        curr = curr->next;
    }

    if (curr == NULL)
    {
        printf("\nData not found");
        return;
    }

    if (curr == head)
        head = head->next;
    else
        prev->next = curr->next;

    free(curr);
    printf("\nData deleted successfully");
}

/* Display list */
void display()
{
    if (head == NULL)
    {
        printf("\nNo data to display");
        return;
    }

    printf("\nList elements:\n");
    for (disp = head; disp != NULL; disp = disp->next)
        printf("Data -> %d\n", disp->data);
}

/* Count size */
int size()
{
    int count = 0;
    for (disp = head; disp != NULL; disp = disp->next)
        count++;
    return count;
}

/* Search item */
void search()
{
    int titem, found = 0;

    if (head == NULL)
    {
        printf("\nNo data in the list");
        return;
    }

    printf("\nEnter the number to search: ");
    scanf("%d", &titem);

    for (disp = head; disp != NULL; disp = disp->next)
    {
        if (disp->data == titem)
        {
            found = 1;
            break;
        }
    }

    if (found)
        printf("\nSearch number is present in the list");
    else
        printf("\nSearch number is not present in the list");
}
