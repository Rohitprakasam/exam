
a) List the sailors in descending order of their rating


SELECT sid, sname, rating, age
FROM SAILOR
ORDER BY rating DESC;


b) List the youngest sailor for each rating who can vote
ðŸ‘‰ Voting age assumed as 18 years


SELECT sid, sname, rating, age
FROM SAILOR s
WHERE age >= 18
AND age = (
    SELECT MIN(age)
    FROM SAILOR
    WHERE rating = s.rating
);


c) List the sailors who have reserved both â€˜REDâ€™ and â€˜GREENâ€™ boats


SELECT s.sid, s.sname
FROM SAILOR s
JOIN RESERVES r ON s.sid = r.sid
JOIN BOATS b ON r.bid = b.bid
WHERE b.colour IN ('RED', 'GREEN')
GROUP BY s.sid, s.sname
HAVING COUNT(DISTINCT b.colour) = 2;


d) Create a synonym for SAILOR table

CREATE SYNONYM sailor_syn FOR SAILOR;


â–¶ Usage
SELECT * FROM sailor_syn;



e) PL/SQL Function that accepts SID and returns Sailor Name


CREATE OR REPLACE FUNCTION get_sailor_name (
    p_sid IN SAILOR.sid%TYPE
) RETURN VARCHAR2 IS
    v_name SAILOR.sname%TYPE;
BEGIN
    SELECT sname
    INTO v_name
    FROM SAILOR
    WHERE sid = p_sid;

    RETURN v_name;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RETURN 'Sailor not found';
    WHEN OTHERS THEN
        RETURN 'Error occurred';
END;
/


â–¶ Function Call
SELECT get_sailor_name(101) FROM dual;
